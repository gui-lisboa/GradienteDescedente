
<!DOCTYPE html>

<html lang="pt">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Implementação e Exemplos &#8212; Gradiente Descendente</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Pesquisar" href="../search.html" />
    <link rel="prev" title="Apresentação Machine Learning - Gradiente Descendente" href="../intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="pt">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Gradiente Descendente</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Pesquisar..." aria-label="Pesquisar..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Implementação e Exemplos
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Alternar de navegação" aria-controls="site-navigation"
                title="Alternar de navegação" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Baixe esta página"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/src/exemplo_simplificado.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Baixar arquivo fonte" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Imprimir em PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Modo tela cheia"
        title="Modo tela cheia"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Conteúdo
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#funcao-custo-erro">
   Função Custo (Erro)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eqm-erro-quadratico-medio">
     EQM - Erro Quadrático Médio
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#outras-opcoes">
     Outras opções
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uso-em-uma-rede-neural">
   Uso em uma Rede Neural
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rede-neural-camadas">
     Rede Neural - Camadas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rede-neural-rede">
     Rede Neural - Rede
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rede-neural-funcao-de-ativacao-sigmoide">
     Rede Neural - Função de Ativação (Sigmóide)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exemplo-ou-exclusivo-xor">
   Exemplo: Ou Exclusivo (XOR)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#entradas-e-saidas-esperadas">
     Entradas e Saídas Esperadas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rede">
     Rede
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#treinamento">
     Treinamento
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#validacao">
     Validação
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exemplo-display-de-7-segmentos">
   Exemplo: Display de 7 Segmentos
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Entradas e Saídas Esperadas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Rede
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Treinamento
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Validação
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Implementação e Exemplos</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Conteúdo </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#funcao-custo-erro">
   Função Custo (Erro)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eqm-erro-quadratico-medio">
     EQM - Erro Quadrático Médio
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#outras-opcoes">
     Outras opções
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uso-em-uma-rede-neural">
   Uso em uma Rede Neural
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rede-neural-camadas">
     Rede Neural - Camadas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rede-neural-rede">
     Rede Neural - Rede
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rede-neural-funcao-de-ativacao-sigmoide">
     Rede Neural - Função de Ativação (Sigmóide)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exemplo-ou-exclusivo-xor">
   Exemplo: Ou Exclusivo (XOR)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#entradas-e-saidas-esperadas">
     Entradas e Saídas Esperadas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rede">
     Rede
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#treinamento">
     Treinamento
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#validacao">
     Validação
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exemplo-display-de-7-segmentos">
   Exemplo: Display de 7 Segmentos
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Entradas e Saídas Esperadas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Rede
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Treinamento
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Validação
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="implementacao-e-exemplos">
<h1>Implementação e Exemplos<a class="headerlink" href="#implementacao-e-exemplos" title="Link permanente para este título">¶</a></h1>
<div class="section" id="funcao-custo-erro">
<h2>Função Custo (Erro)<a class="headerlink" href="#funcao-custo-erro" title="Link permanente para este título">¶</a></h2>
<div class="section" id="eqm-erro-quadratico-medio">
<h3>EQM - Erro Quadrático Médio<a class="headerlink" href="#eqm-erro-quadratico-medio" title="Link permanente para este título">¶</a></h3>
<div class="math notranslate nohighlight">
\[
EQM = \frac{1}{n} \sum_{i} (y_{esperado} - y_{estimado})^2
\]</div>
<div class="math notranslate nohighlight">
\[
\frac{\partial EQM}{\partial Y} = \frac{2}{n} (y_{estimado} - y_{esperado})
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">erro_quadratico_medio</span><span class="p">(</span><span class="n">y_esperado</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_calculado</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">y_esperado</span><span class="o">-</span><span class="n">y_calculado</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">derivada_erro_quadratico_medio</span><span class="p">(</span><span class="n">y_esperado</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_calculado</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">y_esperado</span><span class="o">.</span><span class="n">size</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">y_calculado</span> <span class="o">-</span> <span class="n">y_esperado</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="outras-opcoes">
<h3>Outras opções<a class="headerlink" href="#outras-opcoes" title="Link permanente para este título">¶</a></h3>
<p><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/losses">https://www.tensorflow.org/api_docs/python/tf/keras/losses</a></p>
</div>
</div>
<div class="section" id="uso-em-uma-rede-neural">
<h2>Uso em uma Rede Neural<a class="headerlink" href="#uso-em-uma-rede-neural" title="Link permanente para este título">¶</a></h2>
<p><a class="reference external" href="https://towardsdatascience.com/math-neural-network-from-scratch-in-python-d6da9f29ce65">https://towardsdatascience.com/math-neural-network-from-scratch-in-python-d6da9f29ce65</a></p>
<div class="section" id="rede-neural-camadas">
<h3>Rede Neural - Camadas<a class="headerlink" href="#rede-neural-camadas" title="Link permanente para este título">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">array_to_latex</span>


<span class="k">class</span> <span class="nc">Camada</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entrada</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saida</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">forward_propagation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">logs</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">backward_propagation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">output_error</span><span class="p">,</span> <span class="n">taxa_aprendizado</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">logs</span><span class="p">:</span> <span class="nb">list</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="k">class</span> <span class="nc">FCLayer</span><span class="p">(</span><span class="n">Camada</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tamanho_entrada</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">tamanho_saida</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pesos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">tamanho_entrada</span><span class="p">,</span> <span class="n">tamanho_saida</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">tamanho_saida</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward_propagation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entrada</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">logs</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entrada</span> <span class="o">=</span> <span class="n">entrada</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saida</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrada</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pesos</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>

        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Y = Xw + b&quot;</span><span class="p">)</span>
        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;\begin</span><span class="si">{gather}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saida</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; = &quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrada</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; \cdot &quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pesos</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; + &quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\end</span><span class="si">{gather}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">saida</span>

    <span class="c1"># computes dE/dW, dE/dB for a given output_error=dE/dY. Returns input_error=dE/dX.</span>
    <span class="k">def</span> <span class="nf">backward_propagation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">derivada_erro</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">taxa_aprendizado</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">logs</span><span class="p">:</span> <span class="nb">list</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">derivada_erro_entrada</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">derivada_erro</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pesos</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T&quot;</span><span class="p">)</span>
        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">array_to_latex</span><span class="p">(</span><span class="n">derivada_erro_entrada</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; = &quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="n">derivada_erro</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; \cdot &quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pesos</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">pesos_erro</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrada</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">derivada_erro</span><span class="p">)</span>
        <span class="n">pesos_atualizados</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pesos</span> <span class="o">-</span> <span class="n">taxa_aprendizado</span> <span class="o">*</span> <span class="n">pesos_erro</span>
        <span class="n">bias_atualizados</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">-</span> <span class="n">taxa_aprendizado</span> <span class="o">*</span> <span class="n">derivada_erro</span>

        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;W = W - \lambda (X^T \cdot \nabla f_</span><span class="si">{custo}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;\begin</span><span class="si">{gather}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="n">pesos_atualizados</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; = &quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pesos</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">taxa_aprendizado</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrada</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; \cdot &quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="n">derivada_erro</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\end</span><span class="si">{gather}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;B = B - \lambda (\nabla f_</span><span class="si">{custo}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;\begin</span><span class="si">{gather}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="n">bias_atualizados</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; = &quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">taxa_aprendizado</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="n">derivada_erro</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\end</span><span class="si">{gather}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pesos</span> <span class="o">=</span> <span class="n">pesos_atualizados</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">bias_atualizados</span>

        <span class="k">return</span> <span class="n">derivada_erro_entrada</span>


<span class="k">class</span> <span class="nc">ActivationLayer</span><span class="p">(</span><span class="n">Camada</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn_de_ativacao</span><span class="p">,</span> <span class="n">derivada_fn_de_ativacao</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fn_de_ativacao</span> <span class="o">=</span> <span class="n">fn_de_ativacao</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">derivada_fn_de_ativacao</span> <span class="o">=</span> <span class="n">derivada_fn_de_ativacao</span>

    <span class="k">def</span> <span class="nf">forward_propagation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entrada</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">logs</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entrada</span> <span class="o">=</span> <span class="n">entrada</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saida</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn_de_ativacao</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrada</span><span class="p">)</span>

        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Y = \sigma(X)&quot;</span><span class="p">)</span>
        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;\begin</span><span class="si">{gather}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saida</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; = \sigma(&quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrada</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;) &quot;</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\end</span><span class="si">{gather}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">saida</span>

    <span class="c1"># Returns input_error=dE/dX for a given output_error=dE/dY.</span>
    <span class="c1"># regra da cadeia</span>
    <span class="k">def</span> <span class="nf">backward_propagation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">derivada_erro</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">taxa_aprendizado</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">logs</span><span class="p">:</span> <span class="nb">list</span>
    <span class="p">):</span>
        <span class="n">derivada_erro_entrada</span> <span class="o">=</span> <span class="n">derivada_erro</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivada_fn_de_ativacao</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entrada</span>
        <span class="p">)</span>

        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} \sigma^{&#39;}(X)&quot;</span>
        <span class="p">)</span>
        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;\begin</span><span class="si">{gather}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="n">derivada_erro_entrada</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; = &quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="n">derivada_erro</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; \cdot &quot;</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; \sigma^{&#39;}(&quot;</span>
            <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrada</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;) \end</span><span class="si">{gather}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">derivada_erro_entrada</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rede-neural-rede">
<h3>Rede Neural - Rede<a class="headerlink" href="#rede-neural-rede" title="Link permanente para este título">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RedeNeural</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn_custo</span><span class="p">:</span> <span class="n">callable</span><span class="p">,</span> <span class="n">derivada_fn_custo</span><span class="p">:</span> <span class="n">callable</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camadas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fn_custo</span> <span class="o">=</span> <span class="n">fn_custo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">derivada_fn_custo</span> <span class="o">=</span> <span class="n">derivada_fn_custo</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">camada</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camadas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">camada</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entrada</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">n_entradas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">entrada</span><span class="p">)</span>
        <span class="n">resultado</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_entradas</span><span class="p">):</span>
            <span class="n">saida</span> <span class="o">=</span> <span class="n">entrada</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">camada</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">camadas</span><span class="p">:</span>
                <span class="n">saida</span> <span class="o">=</span> <span class="n">camada</span><span class="o">.</span><span class="n">forward_propagation</span><span class="p">(</span><span class="n">saida</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">resultado</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">saida</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">resultado</span>

    <span class="k">def</span> <span class="nf">treinar</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">vetor_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">y_esperado</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">max_n_iteracoes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">taxa_aprendizado</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">n_amostras</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vetor_x</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iteracao</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_n_iteracoes</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">soma_erros</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_amostras</span><span class="p">):</span>

                <span class="n">output</span> <span class="o">=</span> <span class="n">vetor_x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">indice_camada</span><span class="p">,</span> <span class="n">camada</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camadas</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="p">[</span><span class="n">iteracao</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Camada: </span><span class="si">{</span><span class="n">indice_camada</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="n">camada</span><span class="o">.</span><span class="n">forward_propagation</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="p">[</span><span class="n">iteracao</span><span class="p">])</span>

                <span class="n">erro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn_custo</span><span class="p">(</span><span class="n">y_esperado</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
                <span class="n">soma_erros</span> <span class="o">+=</span> <span class="n">erro</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="p">[</span><span class="n">iteracao</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">r</span><span class="s2">&quot;f_</span><span class="si">{custo}</span><span class="s2">(&quot;</span>
                    <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="n">y_esperado</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;,&quot;</span>
                    <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;) = &quot;</span>
                    <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="n">erro</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="n">valor_derivada_erro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivada_fn_custo</span><span class="p">(</span><span class="n">y_esperado</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="p">[</span><span class="n">iteracao</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">r</span><span class="s2">&quot;\nabla = \frac{\partial E}{\partial Y} = &quot;</span>
                    <span class="o">+</span> <span class="n">array_to_latex</span><span class="p">(</span><span class="n">valor_derivada_erro</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">indice_camada</span><span class="p">,</span> <span class="n">camada</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camadas</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="p">[</span><span class="n">iteracao</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Camada: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camadas</span><span class="p">)</span> <span class="o">-</span> <span class="n">indice_camada</span> <span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="n">valor_derivada_erro</span> <span class="o">=</span> <span class="n">camada</span><span class="o">.</span><span class="n">backward_propagation</span><span class="p">(</span>
                        <span class="n">valor_derivada_erro</span><span class="p">,</span> <span class="n">taxa_aprendizado</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="p">[</span><span class="n">iteracao</span><span class="p">]</span>
                    <span class="p">)</span>

            <span class="n">media_erros</span> <span class="o">=</span> <span class="n">soma_erros</span> <span class="o">/</span> <span class="n">n_amostras</span>
            <span class="k">if</span> <span class="n">iteracao</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">iteracao</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_integer</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;Iteração </span><span class="si">%d</span><span class="s2">/</span><span class="si">%d</span><span class="s2">   MédiaErro=</span><span class="si">%f</span><span class="s2">&quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">iteracao</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_n_iteracoes</span><span class="p">,</span> <span class="n">media_erros</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">media_erros</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;Iteração </span><span class="si">%d</span><span class="s2">/</span><span class="si">%d</span><span class="s2"> MédiaErro=</span><span class="si">%f</span><span class="s2">&quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">iteracao</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_n_iteracoes</span><span class="p">,</span> <span class="n">media_erros</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rede-neural-funcao-de-ativacao-sigmoide">
<h3>Rede Neural - Função de Ativação (Sigmóide)<a class="headerlink" href="#rede-neural-funcao-de-ativacao-sigmoide" title="Link permanente para este título">¶</a></h3>
<div class="math notranslate nohighlight">
\[
\sigma(x) = \frac{1}{1 + e^{-x}} 
\]</div>
<div class="math notranslate nohighlight">
\[
\frac{d \sigma}{dx} = \sigma(x) (1 - \sigma(x))
\]</div>
<p>Sobre sigmóide: <a class="reference external" href="https://towardsdatascience.com/derivative-of-the-sigmoid-function-536880cf918e">https://towardsdatascience.com/derivative-of-the-sigmoid-function-536880cf918e</a></p>
<p>Outras opções:<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/activations">https://www.tensorflow.org/api_docs/python/tf/keras/activations</a></p>
<p>Sobre algumas práticas: <a class="reference external" href="https://mlfromscratch.com/activation-functions-explained/#/">https://mlfromscratch.com/activation-functions-explained/#/</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">sigmoide</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">derivada_sigmoide</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">:</span>
    <span class="n">sigmoide_x</span> <span class="o">=</span> <span class="n">sigmoide</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sigmoide_x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sigmoide_x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="exemplo-ou-exclusivo-xor">
<h2>Exemplo: Ou Exclusivo (XOR)<a class="headerlink" href="#exemplo-ou-exclusivo-xor" title="Link permanente para este título">¶</a></h2>
<p>Operador retorna verdadeiro apenas caso entradas A ou B {(verdadeiro, falso) ou (falso, verdadeiro)} sejam verdadeiras, retornando falso caso ambas sejam verdadeiras ou ainda caso nenhuma seja.</p>
<div class="section" id="entradas-e-saidas-esperadas">
<h3>Entradas e Saídas Esperadas<a class="headerlink" href="#entradas-e-saidas-esperadas" title="Link permanente para este título">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vetor_x_exemplo_XOR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]])</span>
<span class="n">vetor_y_esperado_exemplo_XOR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]]])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rede">
<h3>Rede<a class="headerlink" href="#rede" title="Link permanente para este título">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rede_exemplo_XOR</span> <span class="o">=</span> <span class="n">RedeNeural</span><span class="p">(</span><span class="n">erro_quadratico_medio</span><span class="p">,</span> <span class="n">derivada_erro_quadratico_medio</span><span class="p">)</span>
<span class="n">rede_exemplo_XOR</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">FCLayer</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">rede_exemplo_XOR</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ActivationLayer</span><span class="p">(</span><span class="n">sigmoide</span><span class="p">,</span> <span class="n">derivada_sigmoide</span><span class="p">))</span>
<span class="n">rede_exemplo_XOR</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">FCLayer</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="treinamento">
<h3>Treinamento<a class="headerlink" href="#treinamento" title="Link permanente para este título">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Latex</span><span class="p">,</span> <span class="n">Markdown</span>

<span class="n">rede_exemplo_XOR</span><span class="o">.</span><span class="n">treinar</span><span class="p">(</span>
    <span class="n">vetor_x_exemplo_XOR</span><span class="p">,</span>
    <span class="n">vetor_y_esperado_exemplo_XOR</span><span class="p">,</span>
    <span class="n">max_n_iteracoes</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">taxa_aprendizado</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">for</span> <span class="n">iteracao_log</span> <span class="ow">in</span> <span class="n">rede_exemplo_XOR</span><span class="o">.</span><span class="n">logs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">iteracao_log</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">Latex</span><span class="p">(</span><span class="n">log</span><span class="p">))</span>

<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">Latex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Última \quad iteração:&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">))</span>

<span class="k">for</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">rede_exemplo_XOR</span><span class="o">.</span><span class="n">logs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Latex</span><span class="p">(</span><span class="n">log</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteração 1/1000   MédiaErro=3.605965
Iteração 2/1000   MédiaErro=0.834229
Iteração 3/1000   MédiaErro=0.657384
Iteração 4/1000   MédiaErro=0.596195
Iteração 5/1000   MédiaErro=0.536350
Iteração 10/1000   MédiaErro=0.537396
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteração 100/1000   MédiaErro=0.570621
Iteração 351/1000 MédiaErro=0.001558
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.88834219 &amp; 0.05890479\\
\end{bmatrix} = 
\begin{bmatrix}
  0 &amp; 0\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.98762961 &amp; 0.6745897\\
  0.90022874 &amp; 0.8604508\\
\end{bmatrix} + 
\begin{bmatrix}
  0.88834219 &amp; 0.05890479\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = \sigma(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.70854794 &amp; 0.51472194\\
\end{bmatrix} = \sigma(
\begin{bmatrix}
  0.88834219 &amp; 0.05890479\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.46915689\\
\end{bmatrix} = 
\begin{bmatrix}
  0.70854794 &amp; 0.51472194\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.9343034\\
  0.59657183\\
\end{bmatrix} + 
\begin{bmatrix}
  0.50008953\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}f_{custo}(
\begin{bmatrix}
  0\\
\end{bmatrix},
\begin{bmatrix}
  1.46915689\\
\end{bmatrix}) = 
\begin{bmatrix}
  2.158421953313696\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\nabla = \frac{\partial E}{\partial Y} = 
\begin{bmatrix}
  2.93831377\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  2.74527654 &amp; 1.75291521\\
\end{bmatrix} = 
\begin{bmatrix}
  2.93831377\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.9343034 &amp; 0.59657183\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -0.10666469\\
  -0.15963546\\
\end{bmatrix} = 
\begin{bmatrix}
  0.9343034\\
  0.59657183\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.70854794\\
  0.51472194\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  2.93831377\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -0.96906736\\
\end{bmatrix} = 
\begin{bmatrix}
  0.50008953\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  2.93831377\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} \sigma^{'}(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.5669209 &amp; 0.43784888\\
\end{bmatrix} = 
\begin{bmatrix}
  2.74527654 &amp; 1.75291521\\
\end{bmatrix} \cdot  \sigma^{'}(
\begin{bmatrix}
  0.88834219 &amp; 0.05890479\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  0.85527621 &amp; 0.88710591\\
\end{bmatrix} = 
\begin{bmatrix}
  0.5669209 &amp; 0.43784888\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.98762961 &amp; 0.90022874\\
  0.6745897 &amp; 0.8604508\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.98762961 &amp; 0.6745897\\
  0.90022874 &amp; 0.8604508\\
\end{bmatrix} = 
\begin{bmatrix}
  0.98762961 &amp; 0.6745897\\
  0.90022874 &amp; 0.8604508\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0\\
  0\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.5669209 &amp; 0.43784888\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.60488174 &amp; -0.16001966\\
\end{bmatrix} = 
\begin{bmatrix}
  0.88834219 &amp; 0.05890479\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.5669209 &amp; 0.43784888\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.50511048 &amp; 0.70043114\\
\end{bmatrix} = 
\begin{bmatrix}
  0 &amp; 1\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.98762961 &amp; 0.6745897\\
  0.90022874 &amp; 0.8604508\\
\end{bmatrix} + 
\begin{bmatrix}
  0.60488174 &amp; -0.16001966\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = \sigma(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.81833545 &amp; 0.66828335\\
\end{bmatrix} = \sigma(
\begin{bmatrix}
  1.50511048 &amp; 0.70043114\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -1.16303657\\
\end{bmatrix} = 
\begin{bmatrix}
  0.81833545 &amp; 0.66828335\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -0.10666469\\
  -0.15963546\\
\end{bmatrix} + 
\begin{bmatrix}
  -0.96906736\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}f_{custo}(
\begin{bmatrix}
  1\\
\end{bmatrix},
\begin{bmatrix}
  -1.16303657\\
\end{bmatrix}) = 
\begin{bmatrix}
  4.6787271956407945\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\nabla = \frac{\partial E}{\partial Y} = 
\begin{bmatrix}
  -4.32607314\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  0.46143924 &amp; 0.69059465\\
\end{bmatrix} = 
\begin{bmatrix}
  -4.32607314\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -0.10666469 &amp; -0.15963546\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.66342482\\
  1.28588588\\
\end{bmatrix} = 
\begin{bmatrix}
  -0.10666469\\
  -0.15963546\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.81833545\\
  0.66828335\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -4.32607314\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.19396921\\
\end{bmatrix} = 
\begin{bmatrix}
  -0.96906736\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  -4.32607314\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} \sigma^{'}(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.06859873 &amp; 0.15309151\\
\end{bmatrix} = 
\begin{bmatrix}
  0.46143924 &amp; 0.69059465\\
\end{bmatrix} \cdot  \sigma^{'}(
\begin{bmatrix}
  1.50511048 &amp; 0.70043114\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  0.1710241 &amp; 0.19348226\\
\end{bmatrix} = 
\begin{bmatrix}
  0.06859873 &amp; 0.15309151\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.98762961 &amp; 0.90022874\\
  0.6745897 &amp; 0.8604508\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.98762961 &amp; 0.6745897\\
  0.86592938 &amp; 0.78390504\\
\end{bmatrix} = 
\begin{bmatrix}
  0.98762961 &amp; 0.6745897\\
  0.90022874 &amp; 0.8604508\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0\\
  1\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.06859873 &amp; 0.15309151\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.57058238 &amp; -0.23656541\\
\end{bmatrix} = 
\begin{bmatrix}
  0.60488174 &amp; -0.16001966\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.06859873 &amp; 0.15309151\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.55821198 &amp; 0.43802429\\
\end{bmatrix} = 
\begin{bmatrix}
  1 &amp; 0\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.98762961 &amp; 0.6745897\\
  0.86592938 &amp; 0.78390504\\
\end{bmatrix} + 
\begin{bmatrix}
  0.57058238 &amp; -0.23656541\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = \sigma(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.82609663 &amp; 0.60778816\\
\end{bmatrix} = \sigma(
\begin{bmatrix}
  1.55821198 &amp; 0.43802429\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  3.34966506\\
\end{bmatrix} = 
\begin{bmatrix}
  0.82609663 &amp; 0.60778816\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  1.66342482\\
  1.28588588\\
\end{bmatrix} + 
\begin{bmatrix}
  1.19396921\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}f_{custo}(
\begin{bmatrix}
  1\\
\end{bmatrix},
\begin{bmatrix}
  3.34966506\\
\end{bmatrix}) = 
\begin{bmatrix}
  5.520925915815785\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\nabla = \frac{\partial E}{\partial Y} = 
\begin{bmatrix}
  4.69933013\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  7.81698236 &amp; 6.04280226\\
\end{bmatrix} = 
\begin{bmatrix}
  4.69933013\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  1.66342482 &amp; 1.28588588\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -0.27762559\\
  -0.14221272\\
\end{bmatrix} = 
\begin{bmatrix}
  1.66342482\\
  1.28588588\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.82609663\\
  0.60778816\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  4.69933013\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -1.15569585\\
\end{bmatrix} = 
\begin{bmatrix}
  1.19396921\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  4.69933013\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} \sigma^{'}(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.12299539 &amp; 1.44049355\\
\end{bmatrix} = 
\begin{bmatrix}
  7.81698236 &amp; 6.04280226\\
\end{bmatrix} \cdot  \sigma^{'}(
\begin{bmatrix}
  1.55821198 &amp; 0.43802429\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  2.08084561 &amp; 2.10164486\\
\end{bmatrix} = 
\begin{bmatrix}
  1.12299539 &amp; 1.44049355\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.98762961 &amp; 0.86592938\\
  0.6745897 &amp; 0.78390504\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.42613192 &amp; -0.04565707\\
  0.86592938 &amp; 0.78390504\\
\end{bmatrix} = 
\begin{bmatrix}
  0.98762961 &amp; 0.6745897\\
  0.86592938 &amp; 0.78390504\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  1\\
  0\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  1.12299539 &amp; 1.44049355\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.00908468 &amp; -0.95681219\\
\end{bmatrix} = 
\begin{bmatrix}
  0.57058238 &amp; -0.23656541\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  1.12299539 &amp; 1.44049355\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.30114598 &amp; -0.21856422\\
\end{bmatrix} = 
\begin{bmatrix}
  1 &amp; 1\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.42613192 &amp; -0.04565707\\
  0.86592938 &amp; 0.78390504\\
\end{bmatrix} + 
\begin{bmatrix}
  0.00908468 &amp; -0.95681219\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = \sigma(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.78602779 &amp; 0.44557543\\
\end{bmatrix} = \sigma(
\begin{bmatrix}
  1.30114598 &amp; -0.21856422\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -1.43728377\\
\end{bmatrix} = 
\begin{bmatrix}
  0.78602779 &amp; 0.44557543\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -0.27762559\\
  -0.14221272\\
\end{bmatrix} + 
\begin{bmatrix}
  -1.15569585\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}f_{custo}(
\begin{bmatrix}
  0\\
\end{bmatrix},
\begin{bmatrix}
  -1.43728377\\
\end{bmatrix}) = 
\begin{bmatrix}
  2.065784638029449\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\nabla = \frac{\partial E}{\partial Y} = 
\begin{bmatrix}
  -2.87456754\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  0.7980535 &amp; 0.40880007\\
\end{bmatrix} = 
\begin{bmatrix}
  -2.87456754\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -0.27762559 &amp; -0.14221272\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.85211939\\
  0.49820561\\
\end{bmatrix} = 
\begin{bmatrix}
  -0.27762559\\
  -0.14221272\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.78602779\\
  0.44557543\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.87456754\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.28158792\\
\end{bmatrix} = 
\begin{bmatrix}
  -1.15569585\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  -2.87456754\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} \sigma^{'}(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.13422311 &amp; 0.10098914\\
\end{bmatrix} = 
\begin{bmatrix}
  0.7980535 &amp; 0.40880007\\
\end{bmatrix} \cdot  \sigma^{'}(
\begin{bmatrix}
  1.30114598 &amp; -0.21856422\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  0.05258588 &amp; 0.19539363\\
\end{bmatrix} = 
\begin{bmatrix}
  0.13422311 &amp; 0.10098914\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.42613192 &amp; 0.86592938\\
  -0.04565707 &amp; 0.78390504\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.35902036 &amp; -0.09615164\\
  0.79881783 &amp; 0.73341047\\
\end{bmatrix} = 
\begin{bmatrix}
  0.42613192 &amp; -0.04565707\\
  0.86592938 &amp; 0.78390504\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  1\\
  1\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.13422311 &amp; 0.10098914\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -0.05802687 &amp; -1.00730676\\
\end{bmatrix} = 
\begin{bmatrix}
  0.00908468 &amp; -0.95681219\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.13422311 &amp; 0.10098914\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<hr class="docutils" />
<div class="output text_latex math notranslate nohighlight">
\[Última \quad iteração:\]</div>
<hr class="docutils" />
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.0814675 &amp; -3.44025576\\
\end{bmatrix} = 
\begin{bmatrix}
  0 &amp; 0\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.74444316 &amp; -6.43083202\\
  2.45596705 &amp; 4.15695033\\
\end{bmatrix} + 
\begin{bmatrix}
  0.0814675 &amp; -3.44025576\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = \sigma(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.52035562 &amp; 0.03106079\\
\end{bmatrix} = \sigma(
\begin{bmatrix}
  0.0814675 &amp; -3.44025576\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.04039772\\
\end{bmatrix} = 
\begin{bmatrix}
  0.52035562 &amp; 0.03106079\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.59385472\\
  3.33369079\\
\end{bmatrix} + 
\begin{bmatrix}
  1.28657754\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}f_{custo}(
\begin{bmatrix}
  0\\
\end{bmatrix},
\begin{bmatrix}
  0.04039772\\
\end{bmatrix}) = 
\begin{bmatrix}
  0.0016319754289882249\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\nabla = \frac{\partial E}{\partial Y} = 
\begin{bmatrix}
  0.08079543\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  -0.20957161 &amp; 0.26934699\\
\end{bmatrix} = 
\begin{bmatrix}
  0.08079543\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.59385472 &amp; 3.33369079\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -2.6148759\\
  3.33243601\\
\end{bmatrix} = 
\begin{bmatrix}
  -2.59385472\\
  3.33369079\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.52035562\\
  0.03106079\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.08079543\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.24617982\\
\end{bmatrix} = 
\begin{bmatrix}
  1.28657754\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.08079543\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} \sigma^{'}(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -0.05230607 &amp; 0.00810627\\
\end{bmatrix} = 
\begin{bmatrix}
  -0.20957161 &amp; 0.26934699\\
\end{bmatrix} \cdot  \sigma^{'}(
\begin{bmatrix}
  0.0814675 &amp; -3.44025576\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  0.09142096 &amp; -0.09476461\\
\end{bmatrix} = 
\begin{bmatrix}
  -0.05230607 &amp; 0.00810627\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.74444316 &amp; 2.45596705\\
  -6.43083202 &amp; 4.15695033\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -2.74444316 &amp; -6.43083202\\
  2.45596705 &amp; 4.15695033\\
\end{bmatrix} = 
\begin{bmatrix}
  -2.74444316 &amp; -6.43083202\\
  2.45596705 &amp; 4.15695033\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0\\
  0\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -0.05230607 &amp; 0.00810627\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.10762053 &amp; -3.4443089\\
\end{bmatrix} = 
\begin{bmatrix}
  0.0814675 &amp; -3.44025576\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  -0.05230607 &amp; 0.00810627\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  2.56358759 &amp; 0.71264143\\
\end{bmatrix} = 
\begin{bmatrix}
  0 &amp; 1\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.74444316 &amp; -6.43083202\\
  2.45596705 &amp; 4.15695033\\
\end{bmatrix} + 
\begin{bmatrix}
  0.10762053 &amp; -3.4443089\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = \sigma(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.92848105 &amp; 0.67098456\\
\end{bmatrix} = \sigma(
\begin{bmatrix}
  2.56358759 &amp; 0.71264143\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.05433019\\
\end{bmatrix} = 
\begin{bmatrix}
  0.92848105 &amp; 0.67098456\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.6148759\\
  3.33243601\\
\end{bmatrix} + 
\begin{bmatrix}
  1.24617982\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}f_{custo}(
\begin{bmatrix}
  1\\
\end{bmatrix},
\begin{bmatrix}
  1.05433019\\
\end{bmatrix}) = 
\begin{bmatrix}
  0.0029517690445956613\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\nabla = \frac{\partial E}{\partial Y} = 
\begin{bmatrix}
  0.10866037\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  -0.28413339 &amp; 0.36210373\\
\end{bmatrix} = 
\begin{bmatrix}
  0.10866037\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.6148759 &amp; 3.33243601\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -2.66532045\\
  3.29598129\\
\end{bmatrix} = 
\begin{bmatrix}
  -2.6148759\\
  3.33243601\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.92848105\\
  0.67098456\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.10866037\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.19184964\\
\end{bmatrix} = 
\begin{bmatrix}
  1.24617982\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.10866037\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} \sigma^{'}(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -0.01886759 &amp; 0.07993957\\
\end{bmatrix} = 
\begin{bmatrix}
  -0.28413339 &amp; 0.36210373\\
\end{bmatrix} \cdot  \sigma^{'}(
\begin{bmatrix}
  2.56358759 &amp; 0.71264143\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  -0.46229692 &amp; 0.28596664\\
\end{bmatrix} = 
\begin{bmatrix}
  -0.01886759 &amp; 0.07993957\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.74444316 &amp; 2.45596705\\
  -6.43083202 &amp; 4.15695033\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -2.74444316 &amp; -6.43083202\\
  2.46540085 &amp; 4.11698055\\
\end{bmatrix} = 
\begin{bmatrix}
  -2.74444316 &amp; -6.43083202\\
  2.45596705 &amp; 4.15695033\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0\\
  1\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -0.01886759 &amp; 0.07993957\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.11705433 &amp; -3.48427868\\
\end{bmatrix} = 
\begin{bmatrix}
  0.10762053 &amp; -3.4443089\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  -0.01886759 &amp; 0.07993957\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -2.62738883 &amp; -9.9151107\\
\end{bmatrix} = 
\begin{bmatrix}
  1 &amp; 0\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.74444316 &amp; -6.43083202\\
  2.46540085 &amp; 4.11698055\\
\end{bmatrix} + 
\begin{bmatrix}
  0.11705433 &amp; -3.48427868\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = \sigma(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  6.73963882e-02 &amp; 4.94197645e-05\\
\end{bmatrix} = \sigma(
\begin{bmatrix}
  -2.62738883 &amp; -9.9151107\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.01237955\\
\end{bmatrix} = 
\begin{bmatrix}
  6.73963882e-02 &amp; 4.94197645e-05\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.66532045\\
  3.29598129\\
\end{bmatrix} + 
\begin{bmatrix}
  1.19184964\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}f_{custo}(
\begin{bmatrix}
  1\\
\end{bmatrix},
\begin{bmatrix}
  1.01237955\\
\end{bmatrix}) = 
\begin{bmatrix}
  0.00015325330317443343\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\nabla = \frac{\partial E}{\partial Y} = 
\begin{bmatrix}
  0.0247591\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  -0.06599095 &amp; 0.08160554\\
\end{bmatrix} = 
\begin{bmatrix}
  0.0247591\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.66532045 &amp; 3.29598129\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -2.66615479\\
  3.29598068\\
\end{bmatrix} = 
\begin{bmatrix}
  -2.66532045\\
  3.29598129\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  6.73963882e-02\\
  4.94197645e-05\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.0247591\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.17947009\\
\end{bmatrix} = 
\begin{bmatrix}
  1.19184964\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.0247591\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} \sigma^{'}(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -4.14780247e-03 &amp; 4.03272738e-06\\
\end{bmatrix} = 
\begin{bmatrix}
  -0.06599095 &amp; 0.08160554\\
\end{bmatrix} \cdot  \sigma^{'}(
\begin{bmatrix}
  -2.62738883 &amp; -9.9151107\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  0.01135747 &amp; -0.01020939\\
\end{bmatrix} = 
\begin{bmatrix}
  -4.14780247e-03 &amp; 4.03272738e-06\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.74444316 &amp; 2.46540085\\
  -6.43083202 &amp; 4.11698055\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -2.74236925 &amp; -6.43083404\\
  2.46540085 &amp; 4.11698055\\
\end{bmatrix} = 
\begin{bmatrix}
  -2.74444316 &amp; -6.43083202\\
  2.46540085 &amp; 4.11698055\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  1\\
  0\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -4.14780247e-03 &amp; 4.03272738e-06\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.11912823 &amp; -3.4842807\\
\end{bmatrix} = 
\begin{bmatrix}
  0.11705433 &amp; -3.48427868\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  -4.14780247e-03 &amp; 4.03272738e-06\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -0.15784018 &amp; -5.79813419\\
\end{bmatrix} = 
\begin{bmatrix}
  1 &amp; 1\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.74236925 &amp; -6.43083404\\
  2.46540085 &amp; 4.11698055\\
\end{bmatrix} + 
\begin{bmatrix}
  0.11912823 &amp; -3.4842807\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = \sigma(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.46062168 &amp; 0.00302404\\
\end{bmatrix} = \sigma(
\begin{bmatrix}
  -0.15784018 &amp; -5.79813419\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Y = Xw + b\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -0.03865144\\
\end{bmatrix} = 
\begin{bmatrix}
  0.46062168 &amp; 0.00302404\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.66615479\\
  3.29598068\\
\end{bmatrix} + 
\begin{bmatrix}
  1.17947009\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}f_{custo}(
\begin{bmatrix}
  0\\
\end{bmatrix},
\begin{bmatrix}
  -0.03865144\\
\end{bmatrix}) = 
\begin{bmatrix}
  0.0014939334970757727\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\nabla = \frac{\partial E}{\partial Y} = 
\begin{bmatrix}
  -0.07730287\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 2\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  0.20610142 &amp; -0.25478877\\
\end{bmatrix} = 
\begin{bmatrix}
  -0.07730287\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.66615479 &amp; 3.29598068\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -2.6483511\\
  3.29609756\\
\end{bmatrix} = 
\begin{bmatrix}
  -2.66615479\\
  3.29598068\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.46062168\\
  0.00302404\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -0.07730287\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  1.21812152\\
\end{bmatrix} = 
\begin{bmatrix}
  1.17947009\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  -0.07730287\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 1\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} \sigma^{'}(X)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.05120576 &amp; -0.00076816\\
\end{bmatrix} = 
\begin{bmatrix}
  0.20610142 &amp; -0.25478877\\
\end{bmatrix} \cdot  \sigma^{'}(
\begin{bmatrix}
  -0.15784018 &amp; -5.79813419\\
\end{bmatrix}) \end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Camada: 0\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\frac{\partial E}{\partial X} = \frac{\partial E}{\partial Y} W^T\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  -0.1354852 &amp; 0.12308023\\
\end{bmatrix} = 
\begin{bmatrix}
  0.05120576 &amp; -0.00076816\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  -2.74236925 &amp; 2.46540085\\
  -6.43083404 &amp; 4.11698055\\
\end{bmatrix}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[W = W - \lambda (X^T \cdot \nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  -2.76797214 &amp; -6.43044996\\
  2.43979796 &amp; 4.11736463\\
\end{bmatrix} = 
\begin{bmatrix}
  -2.74236925 &amp; -6.43083404\\
  2.46540085 &amp; 4.11698055\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  1\\
  1\\
\end{bmatrix} \cdot 
\begin{bmatrix}
  0.05120576 &amp; -0.00076816\\
\end{bmatrix}\end{gather}\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[B = B - \lambda (\nabla f_{custo})\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{bmatrix}
  0.09352535 &amp; -3.48389662\\
\end{bmatrix} = 
\begin{bmatrix}
  0.11912823 &amp; -3.4842807\\
\end{bmatrix} - 0.5
\begin{bmatrix}
  0.05120576 &amp; -0.00076816\\
\end{bmatrix}\end{gather}\end{split}\]</div>
</div>
</div>
</div>
<div class="section" id="validacao">
<h3>Validação<a class="headerlink" href="#validacao" title="Link permanente para este título">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">array_to_latex</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Latex</span>

<span class="n">validacao_exemplo_XOR</span> <span class="o">=</span> <span class="n">rede_exemplo_XOR</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">vetor_x_exemplo_XOR</span><span class="p">)</span>
<span class="n">validacao_exemplo_XOR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">validacao_exemplo_XOR</span><span class="p">)</span> \
                          <span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">Latex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\begin</span><span class="si">{gather}</span><span class="s1">&#39;</span> <span class="o">+</span>
      <span class="n">array_to_latex</span><span class="p">(</span><span class="n">vetor_x_exemplo_XOR</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;X=&#39;</span><span class="p">)</span> <span class="o">+</span>
      <span class="sa">r</span><span class="s1">&#39;\rightarrow&#39;</span> <span class="o">+</span>
      <span class="n">array_to_latex</span><span class="p">(</span><span class="n">validacao_exemplo_XOR</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span>
      <span class="sa">r</span><span class="s1">&#39;\end</span><span class="si">{gather}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}X=
\begin{bmatrix}
  0 &amp; 0\\
  0 &amp; 1\\
  1 &amp; 0\\
  1 &amp; 1\\
\end{bmatrix}\rightarrow
\begin{bmatrix}
  -0.06979321\\
  0.91782899\\
  1.04747082\\
  0.05857413\\
\end{bmatrix}\end{gather}\end{split}\]</div>
</div>
</div>
</div>
</div>
<div class="section" id="exemplo-display-de-7-segmentos">
<h2>Exemplo: Display de 7 Segmentos<a class="headerlink" href="#exemplo-display-de-7-segmentos" title="Link permanente para este título">¶</a></h2>
<div class="section" id="id1">
<h3>Entradas e Saídas Esperadas<a class="headerlink" href="#id1" title="Link permanente para este título">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Latex</span>

<span class="n">segmentos</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">]</span>

<span class="n">tabela_segmentos_digitos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="c1">#A, B, C, D, E, F, G</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">segmentos</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">tabela_segmentos_digitos</span><span class="p">)</span>

<span class="n">vetor_y_esperado_exemplo_segmentos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">Latex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\begin</span><span class="si">{gather}</span><span class="s2">&quot;</span> <span class="o">+</span>
      <span class="n">array_to_latex</span><span class="p">(</span><span class="n">vetor_y_esperado_exemplo_segmentos</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="sa">r</span><span class="s2">&quot;Y_</span><span class="si">{esperado}</span><span class="s2">=&quot;</span><span class="p">)</span> <span class="o">+</span>
      <span class="sa">r</span><span class="s2">&quot;\end</span><span class="si">{gather}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}Y_{esperado}=
\begin{bmatrix}
  1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
  0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
  0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
  0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
  0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
  0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
  0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
  0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
  0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
  0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1\\
\end{bmatrix}\end{gather}\end{split}\]</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>Rede<a class="headerlink" href="#id2" title="Link permanente para este título">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vetor_x_exemplo_segmentos</span> <span class="o">=</span> <span class="n">tabela_segmentos_digitos</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="n">rede_exemplo_display</span> <span class="o">=</span> <span class="n">RedeNeural</span><span class="p">(</span><span class="n">erro_quadratico_medio</span><span class="p">,</span> <span class="n">derivada_erro_quadratico_medio</span><span class="p">)</span>
<span class="n">rede_exemplo_display</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">FCLayer</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
<span class="n">rede_exemplo_display</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ActivationLayer</span><span class="p">(</span><span class="n">sigmoide</span><span class="p">,</span> <span class="n">derivada_sigmoide</span><span class="p">))</span>
<span class="n">rede_exemplo_display</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">FCLayer</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h3>Treinamento<a class="headerlink" href="#id3" title="Link permanente para este título">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rede_exemplo_display</span><span class="o">.</span><span class="n">treinar</span><span class="p">(</span>
    <span class="n">vetor_x_exemplo_segmentos</span><span class="p">,</span>
    <span class="n">vetor_y_esperado_exemplo_segmentos</span><span class="p">,</span>
    <span class="n">max_n_iteracoes</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">taxa_aprendizado</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Log do exemplo de 7 segmentos comentado para poder gerar o relatório PDF</span>
<span class="c1">#</span>
<span class="c1">#for log in rede_exemplo_display.logs[0]:</span>
<span class="c1">#    display(Latex(log))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteração 1/1000   MédiaErro=8.995830
Iteração 2/1000   MédiaErro=0.165385
Iteração 3/1000   MédiaErro=0.145206
Iteração 4/1000   MédiaErro=0.132128
Iteração 5/1000   MédiaErro=0.123006
Iteração 10/1000   MédiaErro=0.099717
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteração 100/1000   MédiaErro=0.032410
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteração 223/1000 MédiaErro=0.009865
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3>Validação<a class="headerlink" href="#id4" title="Link permanente para este título">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">array_to_latex</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Latex</span>

<span class="n">validacao_exemplo_display</span> <span class="o">=</span> <span class="n">rede_exemplo_display</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">vetor_x_exemplo_segmentos</span><span class="p">)</span>

<span class="n">validacao_exemplo_display</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">validacao_exemplo_display</span><span class="p">)</span> \
                              <span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>                    \
                              <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">Latex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\begin</span><span class="si">{gather}</span><span class="s1">&#39;</span> <span class="o">+</span>
      <span class="n">array_to_latex</span><span class="p">(</span><span class="n">vetor_x_exemplo_segmentos</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="s1">&#39;X=&#39;</span><span class="p">)</span> <span class="o">+</span>
      <span class="sa">r</span><span class="s1">&#39;\rightarrow&#39;</span> <span class="o">+</span>
      <span class="n">array_to_latex</span><span class="p">(</span><span class="n">validacao_exemplo_display</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span>
      <span class="sa">r</span><span class="s1">&#39;\end</span><span class="si">{gather}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{gather}X=
\begin{bmatrix}
  1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0\\
  0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
  1 &amp; 1 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1\\
  1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1\\
  0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 1\\
  1 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 1\\
  0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\\
  1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
  1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\\
  1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1\\
\end{bmatrix}\rightarrow
\begin{bmatrix}
  0.92 &amp; 0.08 &amp; 0.04 &amp; -0.08 &amp; 0. &amp; 0.06 &amp; -0.05 &amp; -0.02 &amp; 0.15 &amp; -0.01\\
  0.13 &amp; 0.68 &amp; 0.06 &amp; -0.13 &amp; 0.07 &amp; -0.1 &amp; 0.04 &amp; 0.29 &amp; -0.07 &amp; -0.09\\
  -0.06 &amp; 0.02 &amp; 1. &amp; -0.05 &amp; 0. &amp; 0.03 &amp; -0.01 &amp; 0.02 &amp; 0.06 &amp; -0.03\\
  -0.02 &amp; -0.11 &amp; 0.13 &amp; 0.78 &amp; 0. &amp; -0.01 &amp; -0.06 &amp; 0.16 &amp; 0.22 &amp; -0.08\\
  -0.11 &amp; 0.07 &amp; 0.05 &amp; -0.1 &amp; 0.96 &amp; 0.05 &amp; -0.06 &amp; -0.02 &amp; 0.2 &amp; -0.03\\
  -0.05 &amp; -0.02 &amp; 0.09 &amp; -0.19 &amp; -0.04 &amp; 1. &amp; -0.07 &amp; 0.09 &amp; 0.23 &amp; -0.08\\
  -0.08 &amp; 0.05 &amp; 0.1 &amp; -0.18 &amp; -0.03 &amp; 0.03 &amp; 0.91 &amp; 0.01 &amp; 0.25 &amp; -0.06\\
  -0.12 &amp; 0.26 &amp; -0.05 &amp; 0.09 &amp; -0.01 &amp; 0.09 &amp; -0.03 &amp; 0.79 &amp; 0.06 &amp; 0.06\\
  -0. &amp; 0.04 &amp; -0.1 &amp; 0.1 &amp; -0.04 &amp; 0.01 &amp; 0.03 &amp; -0.04 &amp; 0.93 &amp; 0.03\\
  0.01 &amp; -0.01 &amp; 0.01 &amp; -0. &amp; -0. &amp; -0.01 &amp; -0. &amp; 0.01 &amp; -0. &amp; 1.01\\
\end{bmatrix}\end{gather}\end{split}\]</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./src"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../intro.html" title="anterior page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">anterior</p>
            <p class="prev-next-title">Apresentação Machine Learning - Gradiente Descendente</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      De Esdras - Guilherme - Pedro<br/>
    
        &copy; direito autoral 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>